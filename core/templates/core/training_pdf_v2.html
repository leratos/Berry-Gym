<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HomeGym Training Report - Professional Edition</title>
    <style>
        @page {
            size: A4;
            margin: 2cm;
            @bottom-right {
                content: "Seite " counter(page) " von " counter(pages);
                font-size: 8px;
                color: #6c757d;
            }
        }
        
        body {
            font-family: 'Segoe UI', Arial, Helvetica, sans-serif;
            color: #2c3e50;
            font-size: 10px;
            line-height: 1.6;
        }
        
        /* Deckblatt */
        .cover-page {
            page-break-after: always;
            text-align: center;
            padding-top: 150px;
        }
        
        .cover-title {
            font-size: 36px;
            font-weight: bold;
            color: #0d6efd;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .cover-subtitle {
            font-size: 18px;
            color: #6c757d;
            margin-bottom: 50px;
        }
        
        .cover-info {
            font-size: 14px;
            color: #495057;
            margin: 20px 0;
            line-height: 2;
        }
        
        /* Inhaltsverzeichnis */
        .toc-page {
            page-break-after: always;
        }
        
        .toc-title {
            font-size: 24px;
            color: #0d6efd;
            border-bottom: 3px solid #0d6efd;
            padding-bottom: 10px;
            margin-bottom: 25px;
        }
        
        .toc-item {
            padding: 8px 0;
            border-bottom: 1px dotted #dee2e6;
            display: flex;
            justify-content: space-between;
        }
        
        .toc-item-title {
            font-weight: 600;
            color: #495057;
        }
        
        /* Executive Summary */
        .executive-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
            page-break-inside: avoid;
        }
        
        .executive-summary h2 {
            color: white;
            border: none;
            margin-top: 0;
        }
        
        /* √úberschriften */
        h1 {
            color: #0d6efd;
            border-bottom: 4px solid #0d6efd;
            padding-bottom: 12px;
            font-size: 26px;
            margin: 30px 0 20px 0;
            page-break-after: avoid;
        }
        
        h2 {
            color: #495057;
            margin-top: 25px;
            border-bottom: 2px solid #dee2e6;
            padding-bottom: 8px;
            font-size: 18px;
            margin-bottom: 15px;
            page-break-after: avoid;
        }
        
        h3 {
            color: #6c757d;
            font-size: 14px;
            margin-top: 18px;
            margin-bottom: 10px;
            page-break-after: avoid;
        }
        
        /* Tabellen */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0 20px 0;
            font-size: 9px;
            page-break-inside: avoid;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 8px;
            letter-spacing: 0.5px;
        }
        
        td {
            padding: 8px;
            border-bottom: 1px solid #dee2e6;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e7f3ff;
        }
        
        /* Stat Boxes */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.9;
        }
        
        /* Body Map */
        .body-map-container {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            text-align: center;
        }
        
        .body-figures {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
        }
        
        .body-figure {
            width: 45%;
        }
        
        .muscle-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            font-size: 9px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .legend-color {
            width: 20px;
            height: 15px;
            border-radius: 3px;
        }
        
        /* Info Boxes */
        .info-box {
            padding: 15px;
            margin: 15px 0;
            border-radius: 6px;
            border-left: 4px solid;
            page-break-inside: avoid;
        }
        
        .info-box.primary {
            background-color: #e7f3ff;
            border-left-color: #0d6efd;
        }
        
        .info-box.success {
            background-color: #d1f2eb;
            border-left-color: #28a745;
        }
        
        .info-box.warning {
            background-color: #fff3cd;
            border-left-color: #ffc107;
        }
        
        .info-box.danger {
            background-color: #f8d7da;
            border-left-color: #dc3545;
        }
        
        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .badge-success { background-color: #28a745; color: white; }
        .badge-warning { background-color: #ffc107; color: #333; }
        .badge-danger { background-color: #dc3545; color: white; }
        .badge-info { background-color: #17a2b8; color: white; }
        .badge-primary { background-color: #0d6efd; color: white; }
        
        /* Progress Bar */
        .progress-bar-container {
            width: 100%;
            height: 24px;
            background-color: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            text-align: center;
            color: white;
            font-size: 9px;
            line-height: 24px;
            font-weight: 600;
            transition: width 0.3s ease;
        }
        
        /* Two Column Layout */
        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }
        
        /* Charts */
        .chart-container {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Footer */
        .page-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #dee2e6;
            text-align: center;
            color: #6c757d;
            font-size: 8px;
        }
        
        /* Recommendation Box */
        .recommendation-box {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            page-break-inside: avoid;
        }
        
        .recommendation-box h3 {
            color: white;
            margin-top: 0;
        }
        
        .recommendation-box ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .recommendation-box li {
            margin: 8px 0;
        }
    </style>
</head>
<body>
    <!-- DECKBLATT -->
    <div class="cover-page">
        <div style="width: 150px; height: 150px; margin: 0 auto 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
            <span style="font-size: 60px; color: white;">üí™</span>
        </div>
        
        <div class="cover-title">Training Report</div>
        <div class="cover-subtitle">Professional Edition - Trainer Analysis</div>
        
        <div class="cover-info">
            <div><strong>Athlet:</strong> {{ user.get_full_name|default:user.username }}</div>
            <div><strong>Berichtszeitraum:</strong> Letzte 30 Tage</div>
            <div><strong>Erstellt am:</strong> {{ datum|date:"d. F Y, H:i" }} Uhr</div>
            <div><strong>Analysiert von:</strong> HomeGym AI Coach</div>
        </div>
        
        <div style="margin-top: 80px; font-size: 11px; color: #6c757d;">
            <p>Dieser Report enth√§lt detaillierte Trainingsanalysen,</p>
            <p>Muskelgruppen-Balance, Kraftentwicklung und</p>
            <p>professionelle Trainingsempfehlungen.</p>
        </div>
    </div>
    
    <!-- INHALTSVERZEICHNIS -->
    <div class="toc-page">
        <h1 class="toc-title">Inhaltsverzeichnis</h1>
        
        <div class="toc-item">
            <span class="toc-item-title">1. Executive Summary</span>
            <span>Seite 3</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">2. Trainingsstatistiken</span>
            <span>Seite 3</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">3. K√∂rperwerte & Entwicklung</span>
            <span>Seite 4</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">4. Muskelgruppen-Balance</span>
            <span>Seite 4</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">5. Kraftentwicklung</span>
            <span>Seite 5</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">6. Intensit√§ts-Analyse (RPE)</span>
            <span>Seite 5</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">7. Volumen-Progression</span>
            <span>Seite 6</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">8. Top √úbungen</span>
            <span>Seite 6</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">9. Trainingshistorie</span>
            <span>Seite 7</span>
        </div>
        <div class="toc-item">
            <span class="toc-item-title">10. Trainer-Empfehlungen</span>
            <span>Seite 7</span>
        </div>
    </div>
    
    <!-- EXECUTIVE SUMMARY -->
    <div class="executive-summary">
        <h2>üìä Executive Summary</h2>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 15px;">
            <div>
                <div style="font-size: 24px; font-weight: bold;">{{ trainings_30_tage }}</div>
                <div style="font-size: 9px; opacity: 0.9;">Trainings (30T)</div>
            </div>
            <div>
                <div style="font-size: 24px; font-weight: bold;">{{ trainings_pro_woche }}</div>
                <div style="font-size: 9px; opacity: 0.9;">Sessions/Woche</div>
            </div>
            <div>
                <div style="font-size: 24px; font-weight: bold;">{{ avg_rpe|floatformat:1 }}</div>
                <div style="font-size: 9px; opacity: 0.9;">√ò Intensit√§t (RPE)</div>
            </div>
        </div>
        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.3); font-size: 10px;">
            <strong>Gesamtbewertung:</strong>
            {% if trainings_pro_woche >= 3 and avg_rpe >= 7 and avg_rpe <= 8.5 %}
                <span style="font-size: 16px;">‚úÖ Exzellentes Trainingsverhalten</span> - Frequenz und Intensit√§t optimal
            {% elif trainings_pro_woche >= 2 %}
                <span style="font-size: 16px;">‚ö†Ô∏è Gut mit Verbesserungspotenzial</span> - Siehe Empfehlungen
            {% else %}
                <span style="font-size: 16px;">‚ùå Trainingsfrequenz zu niedrig</span> - Mind. 3x/Woche empfohlen
            {% endif %}
        </div>
    </div>
    
    <!-- TRAININGSSTATISTIKEN -->
    <h1>1. Trainingsstatistiken</h1>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">Gesamt Trainings</div>
            <div class="stat-value">{{ gesamt_trainings }}</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">S√§tze (30 Tage)</div>
            <div class="stat-value">{{ saetze_30_tage }}</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Volumen (30T)</div>
            <div class="stat-value">{{ volumen_30_tage|floatformat:0 }}</div>
            <div class="stat-label">kg gesamt</div>
        </div>
    </div>
    
    {% if letzter_koerperwert %}
    <!-- K√ñRPERWERTE -->
    <h1>2. K√∂rperwerte & Entwicklung</h1>
    
    <div class="two-columns">
        <div>
            <h3>Aktuelle Messung ({{ letzter_koerperwert.datum|date:"d.m.Y" }})</h3>
            <table>
                <tr>
                    <th>Messung</th>
                    <th>Wert</th>
                </tr>
                <tr>
                    <td><strong>Gewicht</strong></td>
                    <td><strong>{{ letzter_koerperwert.gewicht }} kg</strong></td>
                </tr>
                {% if letzter_koerperwert.bmi %}
                <tr>
                    <td>BMI</td>
                    <td>{{ letzter_koerperwert.bmi }}</td>
                </tr>
                {% endif %}
                {% if letzter_koerperwert.ffmi %}
                <tr>
                    <td>FFMI</td>
                    <td>{{ letzter_koerperwert.ffmi }}</td>
                </tr>
                {% endif %}
                {% if letzter_koerperwert.koerperfett %}
                <tr>
                    <td>K√∂rperfett</td>
                    <td>{{ letzter_koerperwert.koerperfett }}%</td>
                </tr>
                {% endif %}
            </table>
        </div>
        
        <div>
            <h3>Entwicklung (letzte 5 Messungen)</h3>
            {% if gewichts_trend %}
            <div class="info-box success">
                <strong>üìà Trend:</strong> {{ gewichts_trend.diff|floatformat:1 }} kg {{ gewichts_trend.richtung }}
            </div>
            {% endif %}
            <table>
                <tr>
                    <th>Datum</th>
                    <th>Gewicht</th>
                    <th>√Ñnderung</th>
                </tr>
                {% for kw in koerperwerte %}
                <tr>
                    <td>{{ kw.datum|date:"d.m.Y" }}</td>
                    <td><strong>{{ kw.gewicht }} kg</strong></td>
                    <td>
                        {% if forloop.first %}
                            <span style="color: #6c757d;">Aktuell</span>
                        {% else %}
                            <span style="color: #6c757d;">-</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    {% endif %}
    
    <!-- MUSKELGRUPPEN-BALANCE -->
    <h1>3. Muskelgruppen-Balance (30 Tage)</h1>
    
    <div class="info-box primary">
        <strong>üìñ Interpretationshilfe:</strong> Die Muskelgruppen-Analyse zeigt, welche Bereiche optimal trainiert werden 
        und wo Nachholbedarf besteht. Die Farbcodierung hilft bei der schnellen Identifikation von Schwachstellen.
    </div>
    
    <!-- Push/Pull Balance √úbersicht -->
    {% if push_pull_balance %}
    <div class="two-columns" style="margin-bottom: 20px;">
        <div class="info-box {% if push_pull_balance.bewertung == 'Ausgewogen' %}success{% else %}warning{% endif %}">
            <h3 style="margin-top: 0;">Push/Pull Balance</h3>
            <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">
                {{ push_pull_balance.ratio }}:1
            </div>
            <div><strong>Push:</strong> {{ push_pull_balance.push_saetze }} S√§tze</div>
            <div><strong>Pull:</strong> {{ push_pull_balance.pull_saetze }} S√§tze</div>
            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(0,0,0,0.1);">
                <strong>Bewertung:</strong> {{ push_pull_balance.bewertung }}
            </div>
        </div>
        
        <div class="info-box primary">
            <h3 style="margin-top: 0;">üí° Empfehlung</h3>
            <p>{{ push_pull_balance.empfehlung }}</p>
            <div style="font-size: 9px; margin-top: 10px; opacity: 0.8;">
                <strong>Ideal:</strong> Ratio zwischen 0.9:1 und 1.1:1 f√ºr Schultergesundheit und strukturelle Balance.
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Body Map Visualisierung -->
    <div class="body-map-container">
        <h3 style="margin-top: 0;">Belastungsverteilung</h3>
        
        <!-- Hinweis: Vereinfachte visuelle Darstellung -->
        <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0;">
            <h4 style="text-align: center; color: #6c757d; font-size: 11px; margin-top: 0;">Muskelgruppen-Heatmap</h4>
            
            <table style="width: 100%; margin: 0;">
                <thead>
                    <tr>
                        <th style="width: 50%;">Muskelgruppe</th>
                        <th style="width: 30%;">Belastung</th>
                        <th style="width: 20%;">Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for gruppe in muskelgruppen_stats|slice:":10" %}
                    <tr>
                        <td><strong>{{ gruppe.name }}</strong></td>
                        <td>
                            <div class="progress-bar-container" style="height: 18px;">
                                <div class="progress-bar-fill" style="width: {{ gruppe.prozent_von_optimal }}%; 
                                    {% if gruppe.status == 'optimal' %}background: #28a745;
                                    {% elif gruppe.status == 'untertrainiert' %}background: #ffc107;
                                    {% elif gruppe.status == 'uebertrainiert' %}background: #dc3545;
                                    {% else %}background: #6c757d;{% endif %}">
                                    {{ gruppe.saetze }} S√§tze
                                </div>
                            </div>
                        </td>
                        <td style="text-align: center;">
                            {% if gruppe.status == 'optimal' %}
                                <span style="color: #28a745; font-size: 16px;">‚úì</span>
                            {% elif gruppe.status == 'untertrainiert' %}
                                <span style="color: #ffc107; font-size: 16px;">‚ö†</span>
                            {% elif gruppe.status == 'uebertrainiert' %}
                                <span style="color: #dc3545; font-size: 16px;">‚ö°</span>
                            {% else %}
                                <span style="color: #6c757d; font-size: 16px;">‚óã</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Legende -->
        <div class="muscle-legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #28a745;"></div>
                <span><strong>Optimal</strong> (im Zielbereich)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #ffc107;"></div>
                <span><strong>Untertrainiert</strong> (Volumen erh√∂hen)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #dc3545;"></div>
                <span><strong>Kritisch</strong> (stark untertrainiert)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #6c757d;"></div>
                <span><strong>Nicht trainiert</strong></span>
            </div>
        </div>
    </div>
    
    <!-- Detaillierte Muskelgruppen-Tabelle -->
    <h2>Detaillierte Muskelgruppen-Analyse</h2>
    
    <table>
        <thead>
            <tr>
                <th>Muskelgruppe</th>
                <th>S√§tze (30T)</th>
                <th>Empfehlung</th>
                <th>Prozent</th>
                <th>Status</th>
                <th>Erkl√§rung</th>
            </tr>
        </thead>
        <tbody>
            {% for gruppe in muskelgruppen_stats %}
            <tr>
                <td><strong>{{ gruppe.name }}</strong></td>
                <td>{{ gruppe.saetze }}</td>
                <td>{{ gruppe.empfehlung_min }}-{{ gruppe.empfehlung_max }}</td>
                <td>
                    <div class="progress-bar-container" style="height: 18px;">
                        <div class="progress-bar-fill" style="width: {{ gruppe.prozent_von_optimal }}%; {% if gruppe.prozent_von_optimal < 70 %}background: #dc3545;{% elif gruppe.prozent_von_optimal < 90 %}background: #ffc107;{% endif %}">
                            {{ gruppe.prozent_von_optimal|floatformat:0 }}%
                        </div>
                    </div>
                </td>
                <td>
                    {% if gruppe.status == 'optimal' %}
                        <span class="badge badge-success">{{ gruppe.status_label }}</span>
                    {% elif gruppe.status == 'untertrainiert' %}
                        <span class="badge badge-warning">{{ gruppe.status_label }}</span>
                    {% elif gruppe.status == 'uebertrainiert' %}
                        <span class="badge badge-danger">{{ gruppe.status_label }}</span>
                    {% else %}
                        <span class="badge badge-info">{{ gruppe.status_label }}</span>
                    {% endif %}
                </td>
                <td style="font-size: 8px;">{{ gruppe.erklaerung }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- Schwachstellen Highlight -->
    {% if schwachstellen %}
    <div class="info-box danger">
        <h3 style="margin-top: 0;">‚ö†Ô∏è Identifizierte Schwachstellen</h3>
        <p>Diese Muskelgruppen ben√∂tigen dringend mehr Volumen:</p>
        <ul style="margin: 10px 0 0 20px;">
            {% for schwach in schwachstellen %}
            <li><strong>{{ schwach.name }}:</strong> {{ schwach.erklaerung }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    <!-- KRAFTENTWICKLUNG -->
    {% if kraft_progression %}
    <h1 style="page-break-before: always;">4. Kraftentwicklung - Top 5 √úbungen</h1>
    
    <div class="info-box primary">
        <strong>üìà Interpretation:</strong> Die Kraftentwicklung zeigt die Gewichtssteigerung vom Start bis zur aktuellen Leistung. 
        Positive Werte = Kraftzuwachs, Negative Werte = M√∂glicher √úbertrainingszustand oder Technikfokus.
    </div>
    
    <table>
        <thead>
            <tr>
                <th>√úbung</th>
                <th>Muskelgruppe</th>
                <th>Start-Gewicht</th>
                <th>Aktuell</th>
                <th>Gewinn</th>
                <th>Progression</th>
                <th>Bewertung</th>
            </tr>
        </thead>
        <tbody>
            {% for prog in kraft_progression %}
            <tr>
                <td><strong>{{ prog.uebung }}</strong></td>
                <td><span class="badge badge-info">{{ prog.muskelgruppe }}</span></td>
                <td><strong>{{ prog.start_gewicht|floatformat:1 }} kg</strong></td>
                <td><strong>{{ prog.aktuell_gewicht|floatformat:1 }} kg</strong></td>
                <td>
                    <span style="color: #28a745; font-weight: bold;">Gewinn</span>
                </td>
                <td>
                    {% if prog.progression > 0 %}
                        <span style="color: #28a745; font-weight: bold; font-size: 11px;">+{{ prog.progression }}%</span>
                    {% elif prog.progression < 0 %}
                        <span style="color: #dc3545; font-weight: bold; font-size: 11px;">{{ prog.progression }}%</span>
                    {% else %}
                        <span style="color: #6c757d;">0%</span>
                    {% endif %}
                </td>
                <td>
                    {% if prog.progression > 20 %}
                        <span class="badge badge-success">Exzellent</span>
                    {% elif prog.progression > 10 %}
                        <span class="badge badge-info">Stark</span>
                    {% elif prog.progression > 0 %}
                        <span class="badge badge-primary">Gut</span>
                    {% elif prog.progression < 0 %}
                        <span class="badge badge-warning">Pr√ºfen</span>
                    {% else %}
                        <span class="badge badge-info">Stabil</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    
    <!-- INTENSIT√ÑTS-ANALYSE (RPE) -->
    <h1>5. Intensit√§ts-Analyse (RPE)</h1>
    
    <div class="two-columns">
        <div>
            <h3>RPE-Verteilung (30 Tage)</h3>
            <table>
                <tr>
                    <th>Intensit√§t</th>
                    <th>Anzahl S√§tze</th>
                    <th>Prozent</th>
                    <th>Visualisierung</th>
                </tr>
                <tr>
                    <td><span class="badge badge-success">Leicht (RPE 1-6)</span></td>
                    <td>{{ rpe_verteilung.leicht }}</td>
                    <td>
                        {% widthratio rpe_verteilung.leicht saetze_30_tage 100 as prozent_leicht %}
                        {{ prozent_leicht }}%
                    </td>
                    <td>
                        <div class="progress-bar-container" style="height: 16px;">
                            <div class="progress-bar-fill" style="width: {{ prozent_leicht }}%; background: #28a745;">
                                {{ prozent_leicht }}%
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td><span class="badge badge-warning">Mittel (RPE 7-8)</span></td>
                    <td>{{ rpe_verteilung.mittel }}</td>
                    <td>
                        {% widthratio rpe_verteilung.mittel saetze_30_tage 100 as prozent_mittel %}
                        {{ prozent_mittel }}%
                    </td>
                    <td>
                        <div class="progress-bar-container" style="height: 16px;">
                            <div class="progress-bar-fill" style="width: {{ prozent_mittel }}%; background: #ffc107;">
                                {{ prozent_mittel }}%
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td><span class="badge badge-danger">Schwer (RPE 9-10)</span></td>
                    <td>{{ rpe_verteilung.schwer }}</td>
                    <td>
                        {% widthratio rpe_verteilung.schwer saetze_30_tage 100 as prozent_schwer %}
                        {{ prozent_schwer }}%
                    </td>
                    <td>
                        <div class="progress-bar-container" style="height: 16px;">
                            <div class="progress-bar-fill" style="width: {{ prozent_schwer }}%; background: #dc3545;">
                                {{ prozent_schwer }}%
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        
        <div>
            <h3>Bewertung & Empfehlung</h3>
            <div class="info-box {% if avg_rpe < 6.5 %}warning{% elif avg_rpe <= 8.5 %}success{% else %}danger{% endif %}">
                <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px;">
                    {{ avg_rpe|floatformat:1 }}<span style="font-size: 16px;">/10</span>
                </div>
                <div style="font-size: 10px; margin-bottom: 15px;">Durchschnitts-RPE</div>
                
                {% if avg_rpe < 6.5 %}
                    <div style="padding: 10px; background: white; border-radius: 4px; margin-top: 10px;">
                        <strong>‚ö†Ô∏è Intensit√§t zu niedrig</strong>
                        <p style="margin: 5px 0 0 0;">Steigere die Trainingsintensit√§t f√ºr bessere Hypertrophie-Effekte. Ziel: 70-80% der S√§tze bei RPE 7-9.</p>
                    </div>
                {% elif avg_rpe <= 8.5 %}
                    <div style="padding: 10px; background: white; border-radius: 4px; margin-top: 10px;">
                        <strong>‚úÖ Optimale Intensit√§t</strong>
                        <p style="margin: 5px 0 0 0;">Perfekte Balance zwischen Intensit√§t und Regeneration f√ºr nachhaltigen Muskelaufbau.</p>
                    </div>
                {% else %}
                    <div style="padding: 10px; background: white; border-radius: 4px; margin-top: 10px;">
                        <strong>üö® Intensit√§t zu hoch</strong>
                        <p style="margin: 5px 0 0 0;">Deload-Woche empfohlen! Dauerhafte hohe Intensit√§t erh√∂ht Verletzungs- und √úbertraining-Risiko.</p>
                    </div>
                {% endif %}
            </div>
            
            <div style="margin-top: 15px; font-size: 9px; color: #6c757d; line-height: 1.5;">
                <strong>RPE-Skala Erkl√§rung:</strong><br>
                ‚Ä¢ RPE 6-7: Moderat, k√∂nnte 3-4 Wdh. mehr machen<br>
                ‚Ä¢ RPE 8: Schwer, k√∂nnte 2-3 Wdh. mehr machen<br>
                ‚Ä¢ RPE 9: Sehr schwer, k√∂nnte 1 Wdh. mehr machen<br>
                ‚Ä¢ RPE 10: Maximum, keine weitere Wdh. m√∂glich
            </div>
        </div>
    </div>
    
    <!-- VOLUMEN-PROGRESSION -->
    {% if volumen_wochen %}
    <h1>6. Volumen-Progression (letzte 8 Wochen)</h1>
    
    <div class="info-box primary">
        <strong>üìä Periodisierung:</strong> Gesundes Training zeigt progressive √úberlastung mit gelegentlichen Deload-Wochen. 
        Zu schneller Anstieg = Verletzungsrisiko, zu wenig Variation = Plateau.
    </div>
    
    <table>
        <thead>
            <tr>
                <th>Woche</th>
                <th style="width: 50%;">Volumen-Verlauf</th>
                <th>Gesamt (kg)</th>
                <th>√Ñnderung</th>
            </tr>
        </thead>
        <tbody>
            {% for woche in volumen_wochen %}
            <tr>
                <td><strong>{{ woche.woche }}</strong></td>
                <td>
                    {% widthratio woche.volumen volumen_wochen.0.volumen 100 as prozent %}
                    <div class="progress-bar-container" style="height: 20px;">
                        <div class="progress-bar-fill" style="width: {{ prozent }}%;">
                            {{ prozent }}%
                        </div>
                    </div>
                </td>
                <td><strong>{{ woche.volumen|floatformat:0 }}</strong></td>
                <td>
                    <span style="color: #6c757d;">-</span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    
    <!-- TOP √úBUNGEN -->
    <h1>7. Top 10 √úbungen (Gesamt-Ranking)</h1>
    
    <table>
        <thead>
            <tr>
                <th>Rang</th>
                <th>√úbung</th>
                <th>Muskelgruppe</th>
                <th>S√§tze</th>
                <th>Max Gewicht</th>
                <th>√ò Gewicht</th>
                <th>Total Volumen</th>
            </tr>
        </thead>
        <tbody>
            {% for uebung in top_uebungen %}
            <tr>
                <td><strong>{{ forloop.counter }}</strong></td>
                <td>{{ uebung.uebung__bezeichnung }}</td>
                <td><span class="badge badge-info">{{ uebung.muskelgruppe_display }}</span></td>
                <td>{{ uebung.anzahl }}</td>
                <td><strong>{{ uebung.max_gewicht|floatformat:1 }} kg</strong></td>
                <td>{{ uebung.avg_gewicht|floatformat:1 }} kg</td>
                <td><strong>{{ uebung.total_volumen|floatformat:0 }} kg</strong></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- TRAININGSHISTORIE -->
    <h1 style="page-break-before: always;">8. Trainingshistorie (letzte 20 Sessions)</h1>
    
    <table>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Plan/Typ</th>
                <th>Dauer</th>
                <th>S√§tze</th>
                <th>Notizen</th>
            </tr>
        </thead>
        <tbody>
            {% for training in trainings %}
            <tr>
                <td><strong>{{ training.datum|date:"d.m.Y" }}</strong></td>
                <td>{{ training.plan.name|default:"Freies Training" }}</td>
                <td>{{ training.dauer_minuten|default:"-" }} Min</td>
                <td>{{ training.saetze.count }}</td>
                <td style="font-size: 8px;">{{ training.notizen|default:"-"|truncatewords:10 }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- TRAINER-EMPFEHLUNGEN -->
    <h1>9. Trainer-Empfehlungen & N√§chste Schritte</h1>
    
    <div class="recommendation-box">
        <h2 style="color: white; margin-top: 0; font-size: 18px;">üí™ St√§rken</h2>
        <ul>
            {% if trainings_pro_woche >= 3 %}
            <li><strong>Konsistente Trainingsfrequenz:</strong> {{ trainings_pro_woche }}x/Woche - hervorragende Basis f√ºr Fortschritte</li>
            {% endif %}
            {% if avg_rpe >= 7 and avg_rpe <= 8.5 %}
            <li><strong>Optimale Trainingsintensit√§t:</strong> Durchschnitts-RPE von {{ avg_rpe|floatformat:1 }} liegt im idealen Bereich</li>
            {% endif %}
            {% if kraft_progression %}
                {% for prog in kraft_progression %}
                    {% if prog.progression > 15 and forloop.counter0 < 2 %}
                    <li><strong>Starke Kraftentwicklung:</strong> {{ prog.uebung }} um {{ prog.progression }}% gesteigert</li>
                    {% endif %}
                {% endfor %}
            {% endif %}
            {% if push_pull_balance.bewertung == 'Ausgewogen' %}
            <li><strong>Ausgeglichene Push/Pull-Balance:</strong> Ratio {{ push_pull_balance.ratio }}:1 - optimal f√ºr Schultergesundheit</li>
            {% endif %}
        </ul>
    </div>
    
    <div class="info-box danger">
        <h3 style="margin-top: 0;">‚ö†Ô∏è Verbesserungspotenzial</h3>
        <ul style="margin: 10px 0; line-height: 1.8;">
            {% if trainings_pro_woche < 3 %}
            <li><strong>Trainingsfrequenz zu niedrig:</strong> Steigere auf mindestens 3-4x/Woche f√ºr optimale Hypertrophie</li>
            {% endif %}
            {% if avg_rpe < 6.5 %}
            <li><strong>Intensit√§t erh√∂hen:</strong> Aktueller RPE {{ avg_rpe|floatformat:1 }} ist zu niedrig. Ziel: 70-80% der S√§tze bei RPE 7-9</li>
            {% endif %}
            {% if avg_rpe > 8.5 %}
            <li><strong>Deload empfohlen:</strong> RPE {{ avg_rpe|floatformat:1 }} ist zu hoch. Verletzungsrisiko! Planiere eine leichtere Woche ein</li>
            {% endif %}
            {% if push_pull_balance.bewertung != 'Ausgewogen' %}
            <li><strong>Push/Pull-Unbalance:</strong> {{ push_pull_balance.empfehlung }}</li>
            {% endif %}
            {% for schwach in schwachstellen|slice:":3" %}
            <li><strong>{{ schwach.name }} untertrainiert:</strong> {{ schwach.erklaerung }}</li>
            {% endfor %}
        </ul>
    </div>
    
    <div class="info-box primary">
        <h3 style="margin-top: 0;">üéØ Konkrete Handlungsempfehlungen</h3>
        <ol style="margin: 10px 0 10px 20px; line-height: 1.8;">
            <li><strong>N√§chster Check-in:</strong> In 4 Wochen f√ºr Fortschrittskontrolle</li>
            {% if schwachstellen %}
            <li><strong>Fokus-Muskelgruppen:</strong>
                <ul>
                    {% for schwach in schwachstellen|slice:":2" %}
                    <li>{{ schwach.name }}: {{ schwach.erklaerung }}</li>
                    {% endfor %}
                </ul>
            </li>
            {% endif %}
            <li><strong>Progressive Overload:</strong> Steigere Gewicht um 2.5-5% wenn 3 S√§tze mit RPE 8 oder weniger geschafft wurden</li>
            <li><strong>Regeneration:</strong> Mindestens 48h zwischen gleichen Muskelgruppen, 7-9h Schlaf pro Nacht</li>
            <li><strong>Ern√§hrung √ºberpr√ºfen:</strong> 
                {% if gewichts_trend %}
                    {% if gewichts_trend.richtung == 'zugenommen' %}
                        Gewicht steigt ({{ gewichts_trend.diff|floatformat:1 }} kg). Bei Muskelaufbau OK, sonst Kalorien reduzieren.
                    {% else %}
                        Gewicht sinkt ({{ gewichts_trend.diff|floatformat:1 }} kg). F√ºr Muskelaufbau ggf. Kalorien erh√∂hen.
                    {% endif %}
                {% else %}
                    Ern√§hrungsstatus tracken f√ºr optimale Fortschritte (Kalorien√ºberschuss f√ºr Aufbau, Defizit f√ºr Fettabbau)
                {% endif %}
            </li>
            <li><strong>Deload-Woche:</strong> Alle 4-6 Wochen Volumen um 40-50% reduzieren f√ºr Regeneration</li>
        </ol>
    </div>
    
    <div class="info-box success">
        <h3 style="margin-top: 0;">üìö Zus√§tzliche Ressourcen</h3>
        <ul style="margin: 10px 0; line-height: 1.8;">
            <li><strong>Progressive Overload Guide:</strong> Systematische Steigerung f√ºr langfristige Fortschritte</li>
            <li><strong>RPE-Training-Plan:</strong> Intensit√§tssteuerung f√ºr optimale Ergebnisse</li>
            <li><strong>Injury Prevention Protocol:</strong> Aufw√§rm-Routinen und Mobility-Work</li>
            <li><strong>Nutrition Basics:</strong> Makron√§hrstoff-Verteilung f√ºr Muskelaufbau</li>
        </ul>
    </div>
    
    <div class="page-footer">
        <div style="font-size: 10px; margin-bottom: 10px; color: #495057;">
            <strong>HomeGym App ¬© 2026</strong> | Professional Training Analysis System
        </div>
        <div style="font-size: 8px; color: #6c757d;">
            Dieser Report wurde automatisch generiert basierend auf {{ trainings_30_tage }} Trainingseinheiten mit {{ saetze_30_tage }} S√§tzen.<br>
            Alle Analysen basieren auf wissenschaftlichen Trainingsempfehlungen und individuellen Leistungsdaten.<br>
            Bei Fragen oder f√ºr personalisierte Trainingsplanung kontaktieren Sie Ihren Trainer.
        </div>
    </div>
</body>
</html>
