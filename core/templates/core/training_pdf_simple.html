<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HomeGym Training Report</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            color: #333;
            font-size: 10px;
            line-height: 1.5;
        }
        
        /* Deckblatt */
        .cover-page {
            text-align: center;
            padding-top: 60px;
        }
        
        .cover-title {
            font-size: 36px;
            font-weight: bold;
            color: #0d6efd;
            margin-bottom: 8px;
        }
        
        .cover-subtitle {
            font-size: 14px;
            color: #808080;
            margin-bottom: 30px;
        }
        
        .cover-info {
            font-size: 12px;
            color: #555;
            line-height: 1.8;
        }
        
        /* √úberschriften */
        h1 {
            color: #0d6efd;
            border-bottom: 3px solid #0d6efd;
            padding-bottom: 10px;
            font-size: 22px;
            margin: 25px 0 15px 0;
        }
        
        h2 {
            color: #555;
            border-bottom: 2px solid #ddd;
            padding-bottom: 6px;
            font-size: 16px;
            margin: 20px 0 12px 0;
            page-break-after: avoid;
        }
        
        h3 {
            color: #666;
            font-size: 13px;
            margin: 15px 0 8px 0;
            page-break-after: avoid;
        }
        
        /* Vermeide Seitenumbr√ºche innerhalb von Bildern */
        img {
            page-break-inside: avoid;
            page-break-before: auto;
        }
        
        /* Tabellen */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0 15px 0;
            font-size: 9px;
        }
        
        th {
            background-color: #0d6efd;
            color: white;
            padding: 8px 6px;
            text-align: left;
            font-weight: bold;
        }
        
        td {
            padding: 6px;
            border-bottom: 1px solid #ddd;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        /* Info Boxes */
        .info-box {
            padding: 12px;
            margin: 12px 0;
            border-left: 4px solid #0d6efd;
            background-color: #f8f9fa;
        }
        
        .info-box.success {
            background-color: #d1f2eb;
            border-left-color: #28a745;
        }
        
        .info-box.warning {
            background-color: #fff3cd;
            border-left-color: #ffc107;
        }
        
        .info-box.danger {
            background-color: #f8d7da;
            border-left-color: #dc3545;
        }
        
        /* Badges */
        .badge {
            display: inline-block;
            padding: 3px 8px;
            font-size: 8px;
            font-weight: bold;
        }
        
        .badge-success { background-color: #28a745; color: white; }
        .badge-warning { background-color: #ffc107; color: #333; }
        .badge-danger { background-color: #dc3545; color: white; }
        .badge-info { background-color: #17a2b8; color: white; }
        
        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e9ecef;
            border: 1px solid #ddd;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #0d6efd;
            text-align: center;
            color: white;
            font-size: 8px;
            line-height: 20px;
            font-weight: bold;
        }
        
        /* Footer */
        .page-footer {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 2px solid #ddd;
            text-align: center;
            color: #666;
            font-size: 8px;
        }

        /* Neue Styles f√ºr erweiterte Statistiken */
        .section {
            margin-top: 30px;
            page-break-inside: avoid;
        }

        .stats-grid {
            display: table;
            width: 100%;
            margin-bottom: 20px;
        }

        .stats-row {
            display: table-row;
        }

        .stat-card {
            display: table-cell;
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #198754;
        }

        .stat-label {
            font-size: 9px;
            color: #6c757d;
            margin-top: 5px;
        }

        .bewertung-box {
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid;
        }

        .bewertung-box.success {
            background: #d1e7dd;
            border-color: #198754;
        }

        .bewertung-box.warning {
            background: #fff3cd;
            border-color: #ffc107;
        }

        .bewertung-box.danger {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .fatigue-meter {
            margin: 20px 0;
        }

        .meter-bar {
            width: 100%;
            height: 40px;
            background: #e9ecef;
            border: 1px solid #ddd;
        }

        .meter-fill {
            height: 100%;
            text-align: center;
            color: white;
            font-weight: bold;
            line-height: 40px;
        }

        .meter-fill.success { background: #198754; }
        .meter-fill.warning { background: #ffc107; color: #333; }
        .meter-fill.danger { background: #dc3545; }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }

        .recommendation-box {
            background: #d1e7dd;
            border-left: 4px solid #198754;
            padding: 15px;
            margin: 15px 0;
        }

        .exercise-1rm-card {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            page-break-inside: avoid;
        }

        .rm-value {
            font-size: 16px;
            margin: 10px 0;
            color: #198754;
        }

        .rm-chart {
            margin: 15px 0;
            font-size: 9px;
        }

        .monat-data {
            display: inline-block;
            margin-right: 15px;
        }

        .standards-comparison {
            margin-top: 20px;
        }

        .standards-list {
            display: table;
            width: 100%;
            margin: 15px 0;
        }

        .standards-row {
            display: table-row;
        }

        .standard-item {
            display: table-cell;
            padding: 10px;
            background: white;
            border: 2px solid #e9ecef;
            width: 50%;
        }

        .standard-item.erreicht {
            border-color: #198754;
            background: #d1e7dd;
        }

        .quality-metrics {
            margin: 20px 0;
        }

        .metric {
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
        }

        .metric-value {
            font-weight: bold;
            color: #198754;
            float: right;
        }

        .rpe-distribution {
            margin-top: 20px;
            background: #f8f9fa;
            padding: 15px;
        }

        .rpe-distribution ul {
            list-style: none;
            padding: 0;
        }

        .rpe-distribution li {
            padding: 5px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .text-muted {
            color: #6c757d;
            font-size: 8px;
        }
    </style>
</head>
<body>
    <!-- DECKBLATT -->
    <div class="cover-page">
        <div class="cover-title">Training Report</div>
        <div class="cover-subtitle">Professional Edition - Trainer Analysis</div>
        
        {% if body_map_image %}
        <div style="text-align: center; margin: 20px 0;">
            <img src="data:image/png;base64,{{ body_map_image }}" style="width: auto; height: 500px; margin: 0 auto" alt="Body Map">
        </div>
        
        <!-- Legende unter der Body-Map -->
        <div style="text-align: center; margin: 15px 0 30px 0;">
            <table style="margin: 0 auto; border: none; font-size: 16px;">
                <tr>
                    <td style="width: 35px; height: 25px; background-color: #28a745; border: 1px solid #000;"></td>
                    <td style="padding-left: 10px; padding-right: 30px; font-size: 16px; font-weight: normal;">Optimal</td>
                    <td style="width: 35px; height: 25px; background-color: #ffc107; border: 1px solid #000;"></td>
                    <td style="padding-left: 10px; padding-right: 30px; font-size: 16px; font-weight: normal;">Untertrainiert</td>
                    <td style="width: 35px; height: 25px; background-color: #dc3545; border: 1px solid #000;"></td>
                    <td style="padding-left: 10px; padding-right: 30px; font-size: 16px; font-weight: normal;">√úbertrainiert</td>
                    <td style="width: 35px; height: 25px; background-color: #d9d9d9; border: 1px solid #000;"></td>
                    <td style="padding-left: 10px; font-size: 16px; font-weight: normal;">Nicht trainiert</td>
                </tr>
            </table>
        </div>
        {% endif %}
        
        <div class="cover-info">
            <strong>Athlet:</strong> {{ user.get_full_name|default:user.username }}<br>
            <strong>Berichtszeitraum:</strong> {{ start_datum|date:"d.m.Y" }} - {{ end_datum|date:"d.m.Y" }}
        </div>
        
        <div style="position: absolute; bottom: 80px; width: 100%; text-align: center; font-size: 12px; color: #555;">
            <strong>Erstellt am:</strong> {{ current_date|date:"d.m.Y H:i" }}
        </div>
    </div>
    
    <pdf:nextpage />
    
    <!-- INHALTSVERZEICHNIS -->
    <h1>üìã Inhaltsverzeichnis</h1>
    <table>
        <tr>
            <td>1. Executive Summary</td>
        </tr>
        <tr>
            <td>2. K√∂rperwerte Entwicklung</td>
        </tr>
        <tr>
            <td>3. Muskelgruppen-Analyse</td>
        </tr>
        <tr>
            <td>4. Push/Pull Balance</td>
        </tr>
        <tr>
            <td>5. Trainingsfortschritt</td>
        </tr>
        <tr>
            <td>6. Plateau-Analyse</td>
        </tr>
        <tr>
            <td>7. Trainings-Konsistenz</td>
        </tr>
        <tr>
            <td>8. Erm√ºdungs-Index & Deload</td>
        </tr>
        <tr>
            <td>9. 1RM-Entwicklung & Standards</td>
        </tr>
        <tr>
            <td>10. RPE-Qualit√§tsanalyse</td>
        </tr>
        <tr>
            <td>11. Trainer-Empfehlungen</td>
        </tr>
    </table>
    
    <pdf:nextpage />
    
    <!-- EXECUTIVE SUMMARY -->
    <h1>üìä Executive Summary</h1>
    
    {% if total_einheiten < 8 %}
    <div class="info-box warning">
        <strong>‚ö†Ô∏è Hinweis zur Datenqualit√§t:</strong><br>
        Dieser Bericht basiert auf {{ total_einheiten }} Trainingseinheiten. F√ºr aussagekr√§ftige Analysen und Empfehlungen werden mindestens 8-10 Trainings empfohlen. Aktuelle Bewertungen sollten mit Vorsicht interpretiert werden.
    </div>
    {% endif %}
    
    <div class="info-box success">
        <strong>Trainingseinheiten:</strong> {{ total_einheiten }}<br>
        <strong>Gesamts√§tze:</strong> {{ total_saetze }}<br>
        <strong>Trainingsvolumen:</strong> {{ total_volumen|floatformat:0 }} kg
    </div>
    
    <!-- K√ñRPERWERTE -->
    <h2>K√∂rperentwicklung</h2>
    {% if koerperwerte %}
    <table>
        <thead>
            <tr>
                <th>Datum</th>
                <th>Gewicht</th>
                <th>Brust (cm)</th>
                <th>Taille (cm)</th>
                <th>Bizeps (cm)</th>
            </tr>
        </thead>
        <tbody>
            {% for wert in koerperwerte %}
            <tr>
                <td>{{ wert.datum|date:"d.m.Y" }}</td>
                <td>{{ wert.gewicht|floatformat:1 }} kg</td>
                <td>{{ wert.brustumfang|floatformat:1|default:"-" }}</td>
                <td>{{ wert.taillenumfang|floatformat:1|default:"-" }}</td>
                <td>{{ wert.bizepsumfang|floatformat:1|default:"-" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="info-box warning">
        <strong>Keine K√∂rperdaten erfasst.</strong><br>
        Dieser Bericht fokussiert sich auf Trainingsdaten. F√ºr eine umfassende Analyse empfehlen wir die regelm√§√üige Erfassung von K√∂rperwerten (Gewicht, Umf√§nge). Dies erm√∂glicht pr√§zisere Aussagen zur k√∂rperlichen Entwicklung.
    </div>
    {% endif %}
    
    <pdf:nextpage />
    
    <!-- MUSKELGRUPPEN-ANALYSE -->
    <h1>üéØ Muskelgruppen-Analyse (30 Tage)</h1>
    
    <h2>Trainingsvolumen pro Muskelgruppe</h2>
    <table>
        <thead>
            <tr>
                <th>Muskelgruppe</th>
                <th>S√§tze</th>
                <th>Status</th>
                <th>Erkl√§rung</th>
            </tr>
        </thead>
        <tbody>
            {% for gruppe in muskelgruppen_stats %}
            <tr>
                <td><strong>{{ gruppe.name }}</strong></td>
                <td>{{ gruppe.saetze }}</td>
                <td>
                    {% if gruppe.status == 'optimal' %}
                    <span class="badge badge-success">OPTIMAL</span>
                    {% elif gruppe.status == 'untertrainiert' %}
                    <span class="badge badge-warning">UNTERTRAINIERT</span>
                    {% elif gruppe.status == 'uebertrainiert' %}
                    <span class="badge badge-danger">√úBERTRAINIERT</span>
                    {% else %}
                    <span class="badge badge-info">NICHT TRAINIERT</span>
                    {% endif %}
                </td>
                <td style="font-size: 8px;">{{ gruppe.erklaerung }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- BODY MAP - Matplotlib Heatmap -->
    {% if muscle_heatmap %}
    <div style="page-break-inside: avoid;">
        <h2 style="margin-bottom: 15px; border-bottom: none; padding-bottom: 5px;">Muskel-Balance Visualisierung</h2>
        <div style="text-align: center; margin: 0;">
            <img src="data:image/png;base64,{{ muscle_heatmap }}" style="max-width: 100%; height: auto;" alt="Muskelgruppen Heatmap">
        </div>
    </div>
    {% else %}
    <h2>Muskel-Balance Visualisierung</h2>
    <p style="font-size: 9px; color: #666; margin-bottom: 10px;">
        Balken zeigen das Trainingsvolumen relativ zum optimalen Bereich. Gr√ºn = Optimal, Gelb = Untertrainiert, Rot = √úbertrainiert.
    </p>
    
    <table>
        <thead>
            <tr>
                <th>Muskelgruppe</th>
                <th>Trainingsvolumen</th>
            </tr>
        </thead>
        <tbody>
            {% for gruppe in muskelgruppen_stats %}
            <tr>
                <td><strong>{{ gruppe.name }}</strong></td>
                <td>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: {{ gruppe.prozent_von_optimal }}%; 
                            {% if gruppe.status == 'optimal' %}background: #28a745;
                            {% elif gruppe.status == 'untertrainiert' %}background: #ffc107;
                            {% elif gruppe.status == 'uebertrainiert' %}background: #dc3545;
                            {% else %}background: #6c757d;{% endif %}">
                            {{ gruppe.saetze }} S√§tze
                        </div>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    
    <pdf:nextpage />
    
    <!-- PUSH/PULL BALANCE -->
    <h1>‚öñÔ∏è Push/Pull Balance</h1>
    
    {% if push_pull_chart %}
    <div style="text-align: center; margin: 20px 0;">
        <img src="data:image/png;base64,{{ push_pull_chart }}" style="max-width: 60%; height: auto;" alt="Push/Pull Balance Chart">
    </div>
    {% endif %}
    
    {% if push_pull_bewertung %}
    <div class="info-box {% if push_pull_bewertung == 'Ausgewogen' %}success{% else %}warning{% endif %}">
        <strong>Push-S√§tze:</strong> {{ push_saetze }}<br>
        <strong>Pull-S√§tze:</strong> {{ pull_saetze }}<br>
        <strong>Ratio:</strong> {{ push_pull_ratio|floatformat:2 }}:1<br>
        <strong>Bewertung:</strong> {{ push_pull_bewertung }}
        {% if push_pull_empfehlung %}
        <br><br><strong>Empfehlung:</strong> {{ push_pull_empfehlung }}
        {% endif %}
    </div>
    {% endif %}
    
    <!-- VOLUMEN-ENTWICKLUNG -->
    {% if volume_chart %}
    <div style="page-break-inside: avoid;">
        <h2 style="margin-bottom: 15px; border-bottom: none; padding-bottom: 5px;">Trainingsvolumen-Entwicklung</h2>
        <div style="text-align: center; margin: 0;">
            <img src="data:image/png;base64,{{ volume_chart }}" style="max-width: 100%; height: auto;" alt="Volumen Entwicklung">
        </div>
    </div>
    {% endif %}
    
    <pdf:nextpage />
    
    <!-- TRAININGSFORTSCHRITT -->
    <h1>üìà Trainingsfortschritt</h1>
    
    <h2>Kraftentwicklung Top 5</h2>
    {% if kraftentwicklung %}
    <table>
        <thead>
            <tr>
                <th>√úbung</th>
                <th>Start-Gewicht</th>
                <th>Aktuell</th>
                <th>Entwicklung</th>
            </tr>
        </thead>
        <tbody>
            {% for prog in kraftentwicklung|slice:":5" %}
            <tr>
                <td><strong>{{ prog.uebung }}</strong></td>
                <td>{{ prog.start_gewicht|floatformat:1 }} kg</td>
                <td>{{ prog.aktuell_gewicht|floatformat:1 }} kg</td>
                <td style="color: #28a745; font-weight: bold;">Gewinn</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="info-box warning">
        Noch keine Kraftentwicklung messbar. Fortschritte werden nach mehreren Trainingseinheiten sichtbar.
    </div>
    {% endif %}

    <pdf:nextpage />

    <!-- PLATEAU-ANALYSE -->
    <h1>üéØ Plateau-Analyse - Progression-Tracking</h1>

    {% if plateau_analysis %}
    <table>
        <thead>
            <tr>
                <th>√úbung</th>
                <th>Letzter PR</th>
                <th>Datum</th>
                <th>Tage her</th>
                <th>√ò +kg/Monat</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
        {% for item in plateau_analysis %}
            <tr>
                <td><strong>{{ item.uebung }}</strong><br>
                    <span class="text-muted">{{ item.muskelgruppe }}</span>
                </td>
                <td>{{ item.letzter_pr }} kg</td>
                <td>{{ item.pr_datum }}</td>
                <td>{{ item.tage_seit_pr }}</td>
                <td>+{{ item.progression_pro_monat }} kg</td>
                <td>
                    {% if item.status_farbe == 'success' %}
                    <span class="badge badge-success">{{ item.status_label }}</span>
                    {% elif item.status_farbe == 'warning' %}
                    <span class="badge badge-warning">{{ item.status_label }}</span>
                    {% else %}
                    <span class="badge badge-danger">{{ item.status_label }}</span>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <div class="info-box">
        <p><strong>Legende:</strong></p>
        <ul style="margin: 5px 0; padding-left: 20px; font-size: 8px;">
            <li>‚úÖ Aktive Progression: PR innerhalb der letzten 2 Wochen</li>
            <li>‚ö†Ô∏è Leichtes Plateau: 2-6 Wochen ohne PR</li>
            <li>üî¥ Plateau: >6 Wochen ohne Fortschritt</li>
            <li>‚ö†Ô∏è R√ºckschritt: Leistung &lt;90% des letzten PR</li>
        </ul>
    </div>
    {% else %}
    <div class="info-box warning">
        Noch nicht gen√ºgend Daten f√ºr Plateau-Analyse verf√ºgbar.
    </div>
    {% endif %}

    <pdf:nextpage />

    <!-- KONSISTENZ-ANALYSE -->
    <h1>üìÖ Trainings-Konsistenz</h1>

    {% if consistency_metrics %}
    <div class="stats-grid">
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-value">{{ consistency_metrics.aktueller_streak }}</div>
                <div class="stat-label">Aktueller Streak (Wochen)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ consistency_metrics.laengster_streak }}</div>
                <div class="stat-label">L√§ngster Streak</div>
            </div>
        </div>
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-value">{{ consistency_metrics.adherence_rate }}%</div>
                <div class="stat-label">Training Adherence</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ consistency_metrics.avg_pause_tage }}</div>
                <div class="stat-label">√ò Pause (Tage)</div>
            </div>
        </div>
    </div>

    <div class="bewertung-box {{ consistency_metrics.bewertung_farbe }}">
        <strong>Bewertung:</strong> {{ consistency_metrics.bewertung }}
    </div>
    {% else %}
    <div class="info-box warning">
        Noch nicht gen√ºgend Daten f√ºr Konsistenz-Analyse verf√ºgbar.
    </div>
    {% endif %}

    <pdf:nextpage />

    <!-- ERM√úDUNGS-INDEX -->
    <h1>‚ö° Erm√ºdungs-Index & Deload-Empfehlung</h1>

    {% if fatigue_analysis %}
    <div class="fatigue-meter">
        <div class="meter-bar">
            <div class="meter-fill {{ fatigue_analysis.bewertung_farbe }}"
                 style="width: {{ fatigue_analysis.fatigue_index }}%;">
                {{ fatigue_analysis.fatigue_index }}/100
            </div>
        </div>
        <p style="margin-top: 10px;"><strong>{{ fatigue_analysis.bewertung }}</strong></p>
    </div>

    {% if fatigue_analysis.warnungen %}
    <div class="warning-box">
        <h3 style="margin-top: 0;">‚ö†Ô∏è Warnungen:</h3>
        <ul style="margin: 5px 0; padding-left: 20px; font-size: 9px;">
        {% for warnung in fatigue_analysis.warnungen %}
            <li>{{ warnung }}</li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}

    <div class="recommendation-box">
        <p><strong>Empfehlung:</strong> {{ fatigue_analysis.empfehlung }}</p>
        <p><strong>N√§chste geplante Deload-Woche:</strong> {{ fatigue_analysis.naechste_deload }}</p>
    </div>
    {% else %}
    <div class="info-box warning">
        Noch nicht gen√ºgend Daten f√ºr Erm√ºdungs-Analyse verf√ºgbar.
    </div>
    {% endif %}

    <pdf:nextpage />

    <!-- 1RM-STANDARDS -->
    <h1>üí™ 1RM-Entwicklung & Kraftstandards</h1>

    {% if rm_standards %}
    {% for item in rm_standards %}
    <div class="exercise-1rm-card">
        <h3 style="margin-top: 0;">{{ item.uebung }}</h3>
        <div class="rm-value">Gesch√§tzter 1RM: <strong>{{ item.geschaetzter_1rm }} kg</strong></div>

        <!-- 6-Monats-Entwicklung -->
        <div class="rm-chart">
            <strong>Entwicklung (6 Monate):</strong><br>
            {% for monat in item.1rm_entwicklung %}
                <span class="monat-data">
                    {{ monat.monat }}:
                    {% if monat.1rm %}{{ monat.1rm }} kg{% else %}-{% endif %}
                </span>
            {% endfor %}
        </div>

        <!-- Kraftstandards (falls vorhanden) -->
        {% if item.standard_info %}
        <div class="standards-comparison">
            <p><strong>Aktuelles Level:</strong>
               <span class="badge badge-success">{{ item.standard_info.level_label }}</span>
            </p>

            <div class="standards-list">
                {% for level, gewicht in item.standard_info.alle_levels.items %}
                <div class="standards-row">
                    <div class="standard-item {% if level in item.standard_info.erreicht %}erreicht{% endif %}">
                        <span style="font-weight: bold;">{{ level }}</span>:
                        <span>{{ gewicht }} kg</span>
                        {% if level in item.standard_info.erreicht %} ‚úÖ{% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>

            <div style="margin-top: 10px;">
                <div class="progress-bar">
                    <div class="progress-fill" style="width: {{ item.standard_info.prozent_bis_naechstes }}%; background: #198754;">
                        {{ item.standard_info.prozent_bis_naechstes }}%
                    </div>
                </div>
            </div>
            <p style="font-size: 9px; margin-top: 5px;">
                Noch {{ item.standard_info.naechstes_gewicht|floatformat:1 }} kg bis
                <strong>{{ item.standard_info.naechstes_level }}</strong>
            </p>
        </div>
        {% endif %}
    </div>
    {% endfor %}
    {% else %}
    <div class="info-box warning">
        Noch nicht gen√ºgend Daten f√ºr 1RM-Analyse verf√ºgbar.
    </div>
    {% endif %}

    <pdf:nextpage />

    <!-- RPE-QUALIT√ÑT -->
    <h1>üìà Trainings-Qualit√§t (RPE-Analyse)</h1>

    {% if rpe_quality %}
    <div class="quality-metrics">
        <div class="metric">
            <span>Optimale Intensit√§t (RPE 7-9):</span>
            <span class="metric-value">{{ rpe_quality.optimal_intensity_rate }}%</span>
        </div>
        <div class="metric">
            <span>"Junk Volume" (RPE &lt;6):</span>
            <span class="metric-value">{{ rpe_quality.junk_volume_rate }}%</span>
        </div>
        <div class="metric">
            <span>Bis zum Versagen (RPE 10):</span>
            <span class="metric-value">{{ rpe_quality.failure_rate }}%</span>
        </div>
    </div>

    <div class="bewertung-box {{ rpe_quality.bewertung_farbe }}">
        <strong>Bewertung:</strong> {{ rpe_quality.bewertung }}
    </div>

    {% if rpe_quality.empfehlungen %}
    <div class="recommendation-box">
        <h3 style="margin-top: 0;">Empfehlungen:</h3>
        <ul style="margin: 5px 0; padding-left: 20px; font-size: 9px;">
        {% for emp in rpe_quality.empfehlungen %}
            <li>{{ emp }}</li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- RPE-Verteilung -->
    <div class="rpe-distribution">
        <h3 style="margin-top: 0;">RPE-Verteilung:</h3>
        <ul>
            <li>Sehr leicht (RPE &lt;5): {{ rpe_quality.rpe_verteilung_prozent.sehr_leicht }}%</li>
            <li>Leicht (RPE 5-6): {{ rpe_quality.rpe_verteilung_prozent.leicht }}%</li>
            <li>Moderat (RPE 6-7): {{ rpe_quality.rpe_verteilung_prozent.moderat }}%</li>
            <li>Schwer (RPE 7-9): {{ rpe_quality.rpe_verteilung_prozent.schwer }}%</li>
            <li>Sehr schwer (RPE 9-10): {{ rpe_quality.rpe_verteilung_prozent.sehr_schwer }}%</li>
            <li>Versagen (RPE 10): {{ rpe_quality.rpe_verteilung_prozent.versagen }}%</li>
        </ul>
    </div>
    {% else %}
    <div class="info-box warning">
        Noch nicht gen√ºgend RPE-Daten f√ºr Qualit√§ts-Analyse verf√ºgbar.
    </div>
    {% endif %}

    <pdf:nextpage />

    <!-- TRAINER-EMPFEHLUNGEN -->
    <h1>üéì Trainer-Empfehlungen</h1>
    
    <h2>Deine St√§rken</h2>
    {% if staerken %}
    <div class="info-box success">
        <ul style="margin: 5px 0; padding-left: 20px;">
            {% for staerke in staerken %}
            <li style="margin: 4px 0;"><strong>{{ staerke.name }}:</strong> {{ staerke.saetze }} S√§tze - {{ staerke.erklaerung }}</li>
            {% endfor %}
        </ul>
    </div>
    {% else %}
    <div class="info-box">Beginne mit regelm√§√üigem Training, um St√§rken aufzubauen.</div>
    {% endif %}
    
    <h2>Schwachstellen (Priorit√§t)</h2>
    {% if schwachstellen %}
    <div class="info-box warning">
        <ul style="margin: 5px 0; padding-left: 20px;">
            {% for schwach in schwachstellen %}
            <li style="margin: 4px 0;">
                <strong>{{ schwach.name }}:</strong> {{ schwach.erklaerung }}
            </li>
            {% endfor %}
        </ul>
    </div>
    {% else %}
    <div class="info-box success">Keine Schwachstellen identifiziert - ausgewogenes Training!</div>
    {% endif %}
    
    <h2>N√§chste Schritte</h2>
    <div class="info-box">
        <ol style="margin: 5px 0; padding-left: 20px;">
            {% if schwachstellen %}
            <li style="margin: 4px 0;">Fokussiere auf <strong>{{ schwachstellen.0.name }}</strong> - {{ schwachstellen.0.erklaerung }}</li>
            {% endif %}
            {% if push_pull_empfehlung %}
            <li style="margin: 4px 0;">{{ push_pull_empfehlung }}</li>
            {% endif %}
            <li style="margin: 4px 0;">Erfasse regelm√§√üig K√∂rperwerte f√ºr detaillierte Fortschrittsverfolgung</li>
            <li style="margin: 4px 0;">Steigere Trainingsgewichte progressiv (2,5-5% pro Woche bei guter Form)</li>
        </ol>
    </div>
    
    <!-- FOOTER -->
    <div class="page-footer">
        <p><strong>HomeGym Training Report - Professional Edition</strong></p>
        <p>Erstellt am {{ current_date|date:"d.m.Y H:i" }} | Athlet: {{ user.get_full_name|default:user.username }}</p>
        <p style="margin-top: 10px; font-size: 7px; color: #999;">
            Dieser Report basiert auf evidenzbasierten Trainingsrichtlinien. Empfehlungen sind individuell anzupassen.
        </p>
    </div>
</body>
</html>
